<!DOCTYPE html>
<html lang="en"
      layout:decorate="~{layout}"
      xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout" xmlns:th="http://www.thymeleaf.org">
<head>
	<div layout:fragment="head">
		<meta charset="utf-8"/>
		<title>Manage Users</title>
	</div>
</head>
<body>

<div layout:fragment="content">
	<h2>Registered Users</h2>
	<div class="action-bar">
		<a class="btn secondary" th:href="@{/admin/users/add}">Add User</a>
	</div>
	<table class="booking-table">
		<thead>
		<tr>
			<th>ID</th>
			<th>Role</th>
			<th>Username</th>
			<th>Email</th>
			<th>Actions</th>
		</tr>
		</thead>
		<tbody>
		<tr th:each="user : ${users}">
			<td th:text="${user.id}">1</td>
			<td th:text="${user.role}">User</td>
			<td th:text="${user.username}">Username</td>
			<td th:text="${user.email}">email@example.com</td>
			<td>
				<form method="get" style="display:inline;" th:action="@{/admin/users/edit/{id}(id=${user.id})}">
					<button type="submit">Edit</button>
				</form>

				<button th:onclick="'toggleWarning(' + ${user.id} + ', \'user\', true)'" type="button">Delete</button>
			</td>
		</tr>

		<tr class="warning-row" style="display:none;" th:each="user : ${users}" th:id="'warning-user-' + ${user.id}">
			<td colspan="5">
				<strong>&#9888; Are you sure you want to delete this user? Deleting it will also remove all related
				        bookings.</strong>
				<br/>
				<form style="display:inline;" th:action="@{/admin/users/delete}" th:method="post">
					<input name="id" th:value="${user.id}" type="hidden"/>
					<input name="confirm" type="hidden" value="true"/>
					<button style="background-color:red; color:white;" type="submit">Yes, Delete</button>
				</form>
				<button th:onclick="'toggleWarning(' + ${user.id} + ', \'user\', false)'" type="button">Cancel</button>
			</td>
		</tr>
		</tbody>
	</table>
</div>
<div layout:fragment="scripts">
	<script defer th:src="@{/js/confirmation.js}"></script>
</div>
</body>
</html>